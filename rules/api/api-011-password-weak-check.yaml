id: api-011
name: "弱密碼檢查"
enabled: true
severity: error
description: "檢查密碼是否為常見弱密碼（使用 SHA256 雜湊比對）"

targets:
  file_patterns:
    - "**/api*.yaml"
    - "**/admin*.yaml"
    - "**/user*.yaml"

rule:
  type: hashed_value_check
  path: "admin.password"
  hash_algorithm: "sha256"
  mode: "forbidden"
  hash_list:
    # 常見弱密碼的 SHA256 hash
    - "240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9"  # admin123
    - "5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8"  # password
    - "8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918"  # admin
    - "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"  # (empty string)
    - "65e84be33532fb784c48129675f9eff3a682b27168c0ea744b2cf58ee02337c5"  # qwerty
  message: "密碼不可使用常見弱密碼 (admin123, password, admin, qwerty 等)"
